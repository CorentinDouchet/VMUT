import api from './api';

export const vulnerabilityService = {
  // GET /api/vulnerabilities - Toutes les vulnérabilités
  getAll: () => api.get('/vulnerabilities'),
  
  // GET /api/vulnerabilities/{id} - Une vulnérabilité par ID
  getById: (id) => api.get(`/vulnerabilities/${id}`),
  
  // GET /api/vulnerabilities/scan/{scanName} - Vulnérabilités d'un scan
  getByScan: (scanName) => api.get(`/vulnerabilities/scan/${scanName}`),
  
  // GET /api/vulnerabilities/cve/{cveId} - Vulnérabilités par CVE
  getByCve: (cveId) => api.get(`/vulnerabilities/cve/${cveId}`),
  
  // DELETE /api/vulnerabilities/{id} - Supprimer une vulnérabilité
  delete: (id) => api.delete(`/vulnerabilities/${id}`),

  // PATCH /api/vulnerabilities/{id}/comment-analyst
  updateCommentAnalyst: (id, comment) => api.patch(`/vulnerabilities/${id}/comment-analyst`, { commentsAnalyst: comment }),

  // PATCH /api/vulnerabilities/{id}/validity-status
  updateValidityStatus: (id, status) => api.patch(`/vulnerabilities/${id}/validity-status`, { validityStatus: status }),

  // PATCH /api/vulnerabilities/{id}/rssi-status
  updateRssiStatus: (id, status) => api.patch(`/vulnerabilities/${id}/rssi-status`, { rssiStatus: status }),

  // PATCH /api/vulnerabilities/{id}/metier-status
  updateMetierStatus: (id, status) => api.patch(`/vulnerabilities/${id}/metier-status`, { metierStatus: status }),
};

export default vulnerabilityService;
