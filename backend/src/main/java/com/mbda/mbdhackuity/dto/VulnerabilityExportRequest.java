package com.mbda.mbdhackuity.dto;

import lombok.Data;

import java.util.List;
import java.util.Map;

/**
 * Requête générique pour l'export des vulnérabilités consolidées.
 * Les filtres et colonnes sont dynamiques pour couvrir STB_REQ_0340/0350/0370.
 */
@Data
public class VulnerabilityExportRequest {

    /**
     * Nom fonctionnel du périmètre (asset ou groupe d'assets).
     */
    private String assetName;

    /**
     * Format cible : CSV, EXCEL, DOCX, PDF.
     */
    private String format;

    /**
     * Liste des colonnes à exporter (identifiants côté front).
     * Si vide, on utilisera une liste par défaut.
     */
    private List<String> columns;

    /**
     * Filtres dynamiques appliqués côté backend (même clés que sur le front).
     * Exemples : score {min,max}, rssiStatus, metierStatus, comment, used, date {from,to}, cve, cwe.
     */
    private Map<String, Object> filters;

    /**
     * Nom d'un modèle DOCX optionnel (chargé depuis resources/templates ou uploads/templates).
     */
    private String templateName;

    /**
     * Description libre du périmètre exporté (affichée dans les métadonnées).
     */
    private String scopeDescription;
}

